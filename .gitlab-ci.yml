stages:
  - test

image: golang:1.13-alpine

test:unit:
  stage: test
  script:
  - apk add --update build-base
  - make unittest

test:integration:
  stage: test
  services:
  - registry.gitlab.com/soerenschneider/mountebank-docker
  script:
  - apk add --update build-base curl
  - curl -X POST --data @mountebank/ip-api.json mountebank-docker:2525/imposters
  - make integrationtest
